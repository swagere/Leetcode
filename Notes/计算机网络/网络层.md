## WWW

### 1. www

网站的超链接



### 2. URL

标识互联网上的唯一文档

格式：<协议>://<主机或域名>:<端口>/<路径>

- 协议：http ftp等
- 有时还能加入其他字段 如ftp连接里面还可以加上用户名密码等



### 3. HTTP协议

**特点**

- TCP保证传输层的可靠传输
- 无连接：通信双方在交换http报文之前不需要先建立http连接
  - 对应无状态，无需考虑请求之间的任何关系
- 无状态：即服务器不会记录客户端访问，不存储客户的状态信息



**要求**

服务器必须按照客户端请求的先后顺序依次回送相应的结果，以保证客户端能够区分出每次请求的响应内容



#### 3.1 HTTP1.0 

**过程**

背景：服务端进程监听TCP的80端口，等待客户端建立连接

1. 客户端收到建立连接请求，建立TCP连接
2. 客户端发送请求报文
3. 服务端响应报文，返回响应页面
4. TCP连接释放

> 短连接：请求一次之后马上断开TCP连接，下次请求需重新建立TCP连接



**问题**

- 无法复用连接，每次建立连接开销大，降低网络利用率
- 队头阻塞：即上一个请求的响应到达之后下一个请求才能发出





**实例**

套接字编程，使用Socket进行http请求：

- <img src="C:\Users\12505\AppData\Roaming\Typora\typora-user-images\image-20210726133558601.png" alt="image-20210726133558601" style="zoom: 45%;" /> 

- 代码示例：

  <img src="C:\Users\12505\AppData\Roaming\Typora\typora-user-images\image-20210726133127450.png" alt="image-20210726133127450" style="zoom: 67%;" /> 

  



#### 3.2 HTTP1.1 

**与1.0的区别：**

1. 长连接：服务器发送响应后一段时间内仍然保持连接，即一次TCP连接可以供多轮使用（在同一个服务器上的资源）
   - 非流水线方式：客户端收到前一个响应之后才能发出下一个请求
   - 流水线方式：可以持续发送请求
2. 管道化：即相当于先进先出队列的迁移，发送到对方的时候依旧是有序的，但依然效率较低



#### 3.3 代理服务器

**概念：**

代理服务器是一种高速缓存，将最近的一些请求和响应暂存到代理服务器的本地磁盘中

新请求到达时，若发现与暂存的请求相同，就直接返回暂存的请求



应用：

- 提高访问速度

- 控制流量
- 绕过防火墙



#### 3.4 HTTP报文结构

请求报文：客户端向服务器发送请求

- 方法：GET POST等



响应报文：服务器响应客户端

- 状态码：三位数字



#### 3.5 Cookie

因为http协议的无状态特性，所以增加了cookie用来保存用户的身份



流程：

- 首次访问某个站点时，服务器生成一个唯一的识别码
- 服务器在响应报文中的Set-cookie字段放入识别码
- 客户端收到后 存入缓存/硬盘，放入主机名和识别码
- 客户端在以后的同类请求（默认）中都会加上cookie
  - 同类请求：资源路径相同的请求（URL=资源路径+资源名称）



应用场景：

- 跟踪用户行为/访问过的页面
  - 不一定登陆，登陆后需跟个人信息等关联
  - 将cookie存入后端数据库，并保存跟踪记录
  - 将cookie存入客户端的硬盘中
  - 更改携带cookie的domain域和path路径
- 登陆时记住密码（保存用户名和密码）



> cookie相当于在无状态的http协议上建立了一层用户会话层



#### 3.6 Session



流程：

- 前端发送用户名和密码到后端
- 后端经过验证后生成sessionId，并将sessionId放入cookie中
- 后端存储session（要进行登陆认证）
- 前端访问带上session（通过登陆认证）



应用场景：

- 前后端鉴权



#### 3.7 缓存机制

##### 缓存资源存储

- 硬盘缓存：css等文件，因为只需要加载一次即可渲染，不需要反复加载
- 内存缓存：js等脚本文件，可能随时需要执行



##### 三级缓存原理

- 先到内存中寻找资源
- 如果没有资源再到硬盘中寻找
- 如果没有就向目标网站发出请求
- 将请求存入内存和硬盘，并加载到页面



##### 缓存分类

- 强缓存
  - expires：
    - 用于http1.0
    - 存储过期的绝对时间，但当客户端和服务器时间偏差较大时，会导致缓存混乱
  - cache-control/max-age：
    - 用于http1.1
    - 存储过期的相对时间，相对于请求的时间
  - 可以同时使用，同时使用时后者优先级更高
- 协商缓存
  - last-modified/if-modified-since：
    - 服务端返回客户端服务器上 上一次文件修改时间
      - 如果服务器上此时间之后没有修改 则返回304，客户端将在缓存中加载资源并显示
      - 如果修改则返回200 并将旧资源移除，新资源放入缓存
  - etag/if-none-match：服务端返回客户端校验码
  - 可以同时使用，同时使用时后者优先级更高



##### 缓存机制

- 判断是否命中强缓存，若命中则直接从缓存中加载资源
- 如果没有名字强缓存，则判断是否命中协商缓存，若命中则直接从缓存中加载资源
- 如果都没有命中则保存并加载新资源（如果返回新资源会在协商缓存结果中，所以此时不需要再请求新资源）



### 4. 万维网文档

